!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("immutable"),require("react"),require("react-redux"),require("redux")):"function"==typeof define&&define.amd?define(["immutable","react","react-redux","redux"],t):"object"==typeof exports?exports.ReactUI=t(require("immutable"),require("react"),require("react-redux"),require("redux")):e.ReactUI=t(e.Immutable,e.React,e.ReactRedux,e.Redux)}(this,function(e,t,r,n){return function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={exports:{},id:n,loaded:!1};return e[n].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.reducer=void 0;var i=r(3),u=n(i),o=r(2),a=n(o);t.default=u.default,t.reducer=a.default},function(e,t,r){"use strict";var n=function(e,t,r,n,i,u,o,a){if(!e){var s;if(void 0===t)s=Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[r,n,i,u,o,a],f=0;s=Error(t.replace(/%s/g,function(){return c[f++]})),s.name="Invariant Violation"}throw s.framesToPop=1,s}};e.exports=n},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:I,t=arguments[1],r=t.payload&&(t.payload.key||[]);switch(Array.isArray(r)||(r=[r]),t.type){case h:var n=t.payload,i=n.name,u=n.value;e=e.setIn(r.concat(i),u);break;case l:var o=t.payload,a=o.uiVars,s=o.transforms;e=e.withMutations(function(e){Object.keys(s).forEach(function(t){var r=a[t];(0,p.default)(r,"Couldn't find variable "+t+" within your component's UI state "+("context. Define "+t+" before using it in the @ui decorator")),e.setIn(r.concat(t),s[t])})});break;case y:e=e.setIn(r,new f.Map(t.payload.value));break;case U:var c=t.payload,d=c.defaults,m=c.customReducer;e=e.withMutations(function(e){if(e.setIn(r,new f.Map(d)),m){var t=r.join(".");e.setIn(["__reducers",t],{path:r,func:m})}return e});break;case v:e=e.withMutations(function(e){e.deleteIn(r),e.deleteIn(["__reducers",r.join(".")])})}var b=e.get("__reducers");return b.size>0&&(e=e.withMutations(function(e){return b.forEach(function(r){var n=r.path,i=r.func,u=i(e.getIn(n),t);if(void 0===u)throw Error("Your custom UI reducer at path "+n.join(".")+" must return some state");e.setIn(n,u)}),e})),e}function u(e,t,r){return{type:h,payload:{key:e,name:t,value:r}}}function o(e,t){return{type:l,payload:{uiVars:e,transforms:t}}}function a(e,t){return{type:y,payload:{key:e,value:t}}}function s(e){return{type:v,payload:{key:e}}}function c(e,t,r){return{type:U,payload:{key:e,defaults:t,customReducer:r}}}Object.defineProperty(t,"__esModule",{value:!0}),t.reducerEnhancer=t.defaultState=t.SET_DEFAULT_UI_STATE=t.UPDATE_UI_STATE=t.MASS_UPDATE_UI_STATE=void 0,t.default=i,t.updateUI=u,t.massUpdateUI=o,t.setDefaultUI=a,t.unmountUI=s,t.mountUI=c;var f=r(5),d=r(1),p=n(d),l=t.MASS_UPDATE_UI_STATE="@@redux-ui/MASS_UPDATE_UI_STATE",h=t.UPDATE_UI_STATE="@@redux-ui/UPDATE_UI_STATE",y=t.SET_DEFAULT_UI_STATE="@@redux-ui/SET_DEFAULT_UI_STATE",U="@@redux-ui/MOUNT_UI_STATE",v="@@redux-ui/UNMOUNT_UI_STATE",I=t.defaultState=new f.Map({__reducers:new f.Map({})});t.reducerEnhancer=function(e){return function(t,r){return t=i(t,r),"function"==typeof e&&(t=e(t,r)),t}}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"object"===(void 0===e?"undefined":d(e))&&(t=e,e=t.key);var r=(0,y.connect)(function(e){return{ui:(0,m.getUIState)(e)}},function(e){return(0,h.bindActionCreators)({updateUI:I.updateUI,massUpdateUI:I.massUpdateUI,setDefaultUI:I.setDefaultUI,mountUI:I.mountUI,unmountUI:I.unmountUI},e)},t.mergeProps,t.options);return function(n){var a,h;return r((h=a=function(r){function a(t,r,o){i(this,a);var s=u(this,Object.getPrototypeOf(a).call(this,t,r,o));return s.key=void 0===e?(n.displayName||n.name)+Math.floor(Math.random()*(1<<30)).toString(16):e,s.getMergedContextVars(r),s}return o(a,r),f(a,[{key:"componentWillMount",value:function(){if(void 0===this.props.ui.getIn(this.uiPath)&&t.state){var e=this.getDefaultUIState(t.state);this.context.store.dispatch((0,I.mountUI)(this.uiPath,e,t.reducer))}}},{key:"componentWillReceiveProps",value:function(e){var r=(0,m.getUIState)(this.context.store.getState());if(void 0===r.getIn(this.uiPath)&&t.state){var n=this.getDefaultUIState(t.state,e);this.props.setDefaultUI(this.uiPath,n)}}},{key:"getDefaultUIState",value:function(e){var t=this,r=this.context.store.getState(),n=c({},e);return Object.keys(n).forEach(function(e){"function"==typeof n[e]&&(n[e]=n[e](t.props,r))}),n}},{key:"componentWillUnmount",value:function(){var e=this;t.persist!==!0&&(window&&window.requestAnimationFrame?window.requestAnimationFrame(function(){return e.props.unmountUI(e.uiPath)}):this.props.unmountUI(this.uiPath))}},{key:"getMergedContextVars",value:function(){var e=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.context;if(!this.uiVars||!this.uiPath){var n=r.uiPath||[];this.uiPath=n.concat(this.key);var i=t.state||{};this.uiVars=c({},r.uiVars)||{},Object.keys(i).forEach(function(t){return e.uiVars[t]=e.uiPath},this)}return[this.uiVars,this.uiPath]}},{key:"getChildContext",value:function(){var e=this.getMergedContextVars(),t=s(e,2),r=t[0],n=t[1];return{uiKey:this.key,uiVars:r,uiPath:n,updateUI:this.updateUI.bind(this),resetUI:this.resetUI.bind(this)}}},{key:"resetUI",value:function(){this.props.setDefaultUI(this.uiPath,this.getDefaultUIState(t.state))}},{key:"updateUI",value:function(e,t){var r=this.getMergedContextVars(),i=s(r,1),u=i[0],o=u[e];return"object"===(void 0===e?"undefined":d(e))&&void 0===t?void this.props.massUpdateUI(this.uiVars,e):((0,v.default)(o,"The '"+e+"' UI variable is not defined in the UI context in \""+(n.displayName||n.name)+'" or any parent UI context. Set this variable using the "state" option in the @ui decorator before using it.'),void this.props.updateUI(o,e,t))}},{key:"mergeUIProps",value:function(){var e=this,t=(0,m.getUIState)(this.context.store.getState());return Object.keys(this.uiVars).reduce(function(r,n){return r[n]=t.getIn(e.uiVars[n].concat(n)),r},{})||{}}},{key:"render",value:function(){return l.default.createElement(n,c({},this.props,{uiKey:this.key,uiPath:this.uiPath,ui:this.mergeUIProps(),resetUI:this.resetUI.bind(this),updateUI:this.updateUI.bind(this)}))}}]),a}(p.Component),a.propTypes={ui:g.isRequired,setDefaultUI:T.isRequired,updateUI:T.isRequired,massUpdateUI:T.isRequired},a.childContextTypes={uiKey:x,uiPath:_,uiVars:g,updateUI:T,resetUI:T},a.contextTypes={store:b,uiKey:x,uiPath:_,uiVars:g,updateUI:T,resetUI:T},h))}}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){var r=[],n=!0,i=!1,u=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(s){i=!0,u=s}finally{try{!n&&a.return&&a.return()}finally{if(i)throw u}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),c=Object.assign||function(e){for(var t=1;arguments.length>t;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},f=function(){function e(e,t){for(var r=0;t.length>r;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};t.default=a;var p=r(6),l=n(p),h=r(8),y=r(7),U=r(1),v=n(U),I=r(2),m=r(4),b=p.PropTypes.any,_=p.PropTypes.array,T=p.PropTypes.func,g=p.PropTypes.object,x=p.PropTypes.string},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getUIState=function(e){return"function"==typeof e.get?e.get("ui"):e.ui}},function(t,r){t.exports=e},function(e,r){e.exports=t},function(e,t){e.exports=r},function(e,t){e.exports=n}])});